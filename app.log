2025-05-18 06:02:43,784 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 06:02:46,408 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:05:09,710 - app.core.database - INFO - Value stored securely for key: state:475a4fa9-74a7-44e7-9c9c-7d6e31cd5860
2025-05-18 06:40:07,307 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 06:40:09,772 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:40:24,958 - app.core.database - INFO - Value stored securely for key: state:1dd9c41c-fe18-458f-8305-a5d80b8c3167
2025-05-18 06:43:38,132 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:43:59,314 - app.core.database - INFO - Value stored securely for key: state:820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:44:01,038 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:46:51,185 - app.core.database - INFO - Value deleted for key: state:820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:46:52,194 - app.api.routes.auth - INFO - Created new user: michael@standardbearersschool.ng
2025-05-18 06:46:52,301 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 06:46:52,467 - app.core.database - ERROR - Database error: Textual SQL expression '\n    SELECT DISTINCT p.na...' should be explicitly declared as text('\n    SELECT DISTINCT p.na...')
2025-05-18 06:50:16,784 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:50:23,437 - app.api.routes.auth - WARNING - Invalid state parameter: 820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:50:23,443 - app.core.database - ERROR - Database error: 400: Invalid state parameter
2025-05-18 06:50:59,623 - app.core.database - INFO - Value stored securely for key: state:c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:01,576 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:14,175 - app.core.database - INFO - Value deleted for key: state:c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:15,157 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 06:51:15,168 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: role_permission
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN role_permission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('8aafd2a4-768e-4ed0-96ca-e38592b1d400'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:05:02,296 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 07:05:04,729 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:07:55,351 - app.api.routes.auth - WARNING - Invalid state parameter: c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 07:07:55,355 - app.core.database - ERROR - Database error: 400: Invalid state parameter
2025-05-18 07:08:09,571 - app.core.database - INFO - Value stored securely for key: state:c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:11,680 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:21,322 - app.core.database - INFO - Value deleted for key: state:c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:22,362 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 07:08:22,372 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: role_permission
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN role_permission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('8aafd2a4-768e-4ed0-96ca-e38592b1d400'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:11:51,877 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:12:16,216 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:14:02,087 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:16:13,565 - app.core.database - INFO - Value stored securely for key: state:4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:15,383 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:23,704 - app.core.database - INFO - Value deleted for key: state:4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:24,793 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: user
[SQL: SELECT user.id, user.email, user.full_name, user.azure_object_id, user.is_active, user.is_superuser 
FROM user 
WHERE user.azure_object_id = ?]
[parameters: ('1de44d69-ac21-4f02-80df-5481bb7db336',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:27:07,673 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:30:56,516 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:33:01,582 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:33:26,962 - app.core.database - INFO - Value stored securely for key: state:09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:34:44,576 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:35:00,744 - app.core.database - INFO - Value deleted for key: state:09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:35:01,963 - app.api.routes.auth - INFO - Created new user: michael@standardbearersschool.ng
2025-05-18 07:35:01,986 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:35:01,993 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: user_role
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN rolepermission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('3d265172-0d2a-4334-9491-0232e825922f'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:37:08,914 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:37:23,349 - app.core.database - INFO - Value stored securely for key: state:40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:25,542 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:34,839 - app.core.database - INFO - Value deleted for key: state:40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:35,958 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:37:35,964 - app.core.database - ERROR - Database error: (sqlite3.ProgrammingError) Error binding parameter 1: type 'UUID' is not supported
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN rolepermission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN userrole ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('3d265172-0d2a-4334-9491-0232e825922f'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-18 07:42:23,489 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:42:36,436 - app.core.database - INFO - Value stored securely for key: state:f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:38,584 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:53,674 - app.core.database - INFO - Value deleted for key: state:f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:54,838 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:42:54,855 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 10:42:54.855515
2025-05-18 07:42:54,856 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 06:42:54.856513
2025-05-18 07:48:54,006 - app.core.database - INFO - Value stored securely for key: state:0700d50e-90e6-49d8-9d1e-1ec0ec935e1d
2025-05-18 07:48:54,657 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 0700d50e-90e6-49d8-9d1e-1ec0ec935e1d
2025-05-18 08:10:25,227 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:11:10,724 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:12:31,623 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:18:40,764 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:21:32,364 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:23:40,124 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:27:03,873 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:28:09,339 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:30:45,997 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:03:32,052 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 09:03:34,696 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:04:04,003 - app.core.database - INFO - Value stored securely for key: state:ba9cf14c-f96b-4ba6-99da-1f466972f80a
2025-05-18 09:04:06,801 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: ba9cf14c-f96b-4ba6-99da-1f466972f80a
2025-05-18 09:05:59,554 - app.core.database - INFO - Value stored securely for key: state:fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:00,265 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:17,987 - app.core.database - INFO - Value deleted for key: state:fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:19,057 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:06:19,080 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:06:19.080754
2025-05-18 09:06:19,101 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:06:19.101348
2025-05-18 09:12:18,737 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:23:43,935 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:23:45,142 - app.core.database - INFO - Value stored securely for key: state:4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:23:47,128 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:23:59,570 - app.core.database - INFO - Value deleted for key: state:4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:24:00,737 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:24:00,747 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:24:00.747738
2025-05-18 09:24:00,748 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:24:00.748734
2025-05-18 09:25:33,701 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:25:56,439 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:26:14,695 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:26:47,643 - app.core.database - INFO - Value stored securely for key: state:d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:49,736 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:54,043 - app.core.database - INFO - Value deleted for key: state:d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:55,097 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:26:55,105 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:26:55.104611
2025-05-18 09:26:55,106 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:26:55.105609
2025-05-18 09:41:28,338 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:41:47,761 - app.core.database - INFO - Value stored securely for key: state:238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:49,867 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:54,844 - app.core.database - INFO - Value deleted for key: state:238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:55,880 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:41:55,888 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:41:55.887804
2025-05-18 09:41:55,889 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:41:55.888802
2025-05-18 09:44:47,831 - app.core.database - INFO - Value stored securely for key: state:8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:48,638 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:54,586 - app.core.database - INFO - Value deleted for key: state:8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:55,659 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:44:55,675 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:44:55.675788
2025-05-18 09:44:55,694 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:44:55.694344
2025-05-18 09:48:23,481 - app.core.database - ERROR - Database error: 401: Not authenticated
2025-05-18 09:56:28,430 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:56:50,100 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:03:17,571 - app.core.database - INFO - Value stored securely for key: state:b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:19,924 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:25,914 - app.core.database - INFO - Value deleted for key: state:b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:27,010 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 10:03:27,033 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 13:03:27.031883
2025-05-18 10:03:27,034 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 09:03:27.034882
2025-05-18 10:05:55,671 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 10:05:59,227 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:33:07,134 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:36:56,183 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:37:23,013 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:39:56,529 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:47:23,449 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:49:07,384 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:49:07,460 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-5' coro=<run_drift_detection_job() done, defined at C:\Users\bethel-babashola\Documents\darkmyke\blindspot-assessments\blindspotx_auth\app\main.py:70> exception=NameError("name 'detect_drift' is not defined")>
Traceback (most recent call last):
  File "C:\Users\bethel-babashola\Documents\darkmyke\blindspot-assessments\blindspotx_auth\app\main.py", line 72, in run_drift_detection_job
    await detect_drift()
          ^^^^^^^^^^^^
NameError: name 'detect_drift' is not defined
2025-05-18 10:51:24,731 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:51:24,803 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:51:24,805 - app.services.drift_service - ERROR - Error during drift detection: name 'get_mal_app' is not defined
2025-05-18 10:52:17,132 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:52:17,190 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:52:20,779 - app.services.drift_service - ERROR - Error during drift detection: name 'settings' is not defined
2025-05-18 10:53:32,102 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:53:32,163 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:53:34,382 - app.services.drift_service - ERROR - Error during drift detection: 'NoneType' object has no attribute 'get'
2025-05-18 11:00:06,194 - app.core.database - INFO - Database and tables created successfully
2025-05-18 11:00:06,270 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 11:00:08,316 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 11:04:53,440 - app.core.database - INFO - Value stored securely for key: state:1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:04:54,320 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:05:03,890 - app.core.database - INFO - Value deleted for key: state:1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:05:05,237 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 11:05:05,247 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 14:05:05.247903
2025-05-18 11:05:05,250 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 10:05:05.250026
2025-05-18 11:19:18,571 - app.core.database - INFO - Database and tables created successfully
2025-05-18 11:19:18,627 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 11:19:20,810 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 11:57:42,813 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 11:57:59,666 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C74101790>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)")': /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration
2025-05-18 11:58:03,210 - app.services.drift_service - ERROR - Error during drift detection: HTTPSConnectionPool(host='login.microsoftonline.com', port=443): Max retries exceeded with url: /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C741019A0>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-18 15:17:37,278 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 15:17:40,168 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C74100770>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)")': /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration
2025-05-18 15:17:41,377 - app.services.drift_service - ERROR - Error during drift detection: HTTPSConnectionPool(host='login.microsoftonline.com', port=443): Max retries exceeded with url: /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C741025D0>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-18 18:26:27,513 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 18:26:30,150 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C740D4320>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)")': /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration
2025-05-18 18:26:31,038 - app.services.drift_service - ERROR - Error during drift detection: HTTPSConnectionPool(host='login.microsoftonline.com', port=443): Max retries exceeded with url: /09245053-74f3-4b74-ab1c-f24435a921fe/v2.0/.well-known/openid-configuration (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000026C74101CD0>: Failed to resolve 'login.microsoftonline.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-18 18:56:31,366 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 18:56:32,444 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 18:59:23,841 - app.core.database - INFO - Database and tables created successfully
2025-05-18 18:59:23,885 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 18:59:25,846 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 18:59:51,941 - app.core.database - INFO - Value stored securely for key: state:bf5e1142-f018-4e7f-aeb3-bf1ac7da6c12
2025-05-18 18:59:52,564 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: bf5e1142-f018-4e7f-aeb3-bf1ac7da6c12
2025-05-18 18:59:58,798 - app.core.database - INFO - Value deleted for key: state:bf5e1142-f018-4e7f-aeb3-bf1ac7da6c12
2025-05-18 18:59:59,747 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 18:59:59,759 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 21:59:59.759964
2025-05-18 18:59:59,760 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 17:59:59.759964
2025-05-18 19:06:28,593 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:06:28,689 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:06:30,750 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:12:02,925 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:12:02,987 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:12:05,221 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:12:56,336 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:12:56,396 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:12:58,215 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:14:01,600 - app.core.database - INFO - Value stored securely for key: state:d493485c-2e87-45ee-b949-f09aefbf2428
2025-05-18 19:14:02,267 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: d493485c-2e87-45ee-b949-f09aefbf2428
2025-05-18 19:14:09,073 - app.core.database - INFO - Value deleted for key: state:d493485c-2e87-45ee-b949-f09aefbf2428
2025-05-18 19:14:09,954 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 19:14:09,966 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 22:14:09.966263
2025-05-18 19:14:09,967 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 18:14:09.967262
2025-05-18 19:29:24,618 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:29:24,738 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:29:28,023 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:30:20,775 - app.core.database - INFO - Value stored securely for key: state:73a82d3f-4a69-4d44-b0ba-0f392dcc346a
2025-05-18 19:30:21,415 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 73a82d3f-4a69-4d44-b0ba-0f392dcc346a
2025-05-18 19:30:27,747 - app.core.database - INFO - Value deleted for key: state:73a82d3f-4a69-4d44-b0ba-0f392dcc346a
2025-05-18 19:30:28,677 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 19:30:28,686 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 22:30:28.686120
2025-05-18 19:30:28,687 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 18:30:28.686120
2025-05-18 19:35:24,953 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:35:24,995 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:35:26,732 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:39:39,923 - app.core.database - INFO - Value stored securely for key: state:567328ea-b4a6-4e87-bcbd-2a75ae5b54e0
2025-05-18 19:39:40,570 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 567328ea-b4a6-4e87-bcbd-2a75ae5b54e0
2025-05-18 19:39:45,397 - app.core.database - INFO - Value deleted for key: state:567328ea-b4a6-4e87-bcbd-2a75ae5b54e0
2025-05-18 19:39:46,291 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 19:39:46,297 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 22:39:46.297680
2025-05-18 19:39:46,298 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 18:39:46.298682
2025-05-18 19:42:17,332 - app.core.database - INFO - Value stored securely for key: state:a6a84865-9842-4463-b03e-47ba55a4f50c
2025-05-18 19:42:17,968 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: a6a84865-9842-4463-b03e-47ba55a4f50c
2025-05-18 19:42:26,323 - app.core.database - INFO - Value deleted for key: state:a6a84865-9842-4463-b03e-47ba55a4f50c
2025-05-18 19:42:27,271 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 19:42:27,277 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 22:42:27.276217
2025-05-18 19:42:27,280 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 18:42:27.280218
2025-05-18 19:46:19,382 - app.core.database - INFO - Database and tables created successfully
2025-05-18 19:46:19,452 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 19:46:21,571 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 19:46:46,530 - app.core.database - INFO - Value stored securely for key: state:6371b3c4-849c-45a7-83fa-c646d4677dc7
2025-05-18 19:46:47,169 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 6371b3c4-849c-45a7-83fa-c646d4677dc7
2025-05-18 19:46:53,309 - app.core.database - INFO - Value deleted for key: state:6371b3c4-849c-45a7-83fa-c646d4677dc7
2025-05-18 19:46:54,219 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 19:46:54,227 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 22:46:54.227717
2025-05-18 19:46:54,228 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 18:46:54.228738
2025-05-18 20:16:21,626 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 20:16:23,883 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 20:46:23,943 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 20:46:25,023 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 21:16:25,087 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 21:16:26,600 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 21:46:26,642 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 21:46:27,757 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 22:16:27,808 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 22:16:29,860 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 22:46:29,953 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 22:46:30,875 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-20 06:59:37,504 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-20 07:15:05,371 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-20 07:17:22,572 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:18:11,762 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:20:25,963 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:21:10,963 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:22:02,760 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:22:13,040 - app.services.drift_service - ERROR - Could not retrieve access token for drift detection
2025-05-20 07:23:05,769 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:06","request-id":"54d747f5-e428-4cce-80e9-b42171872158","client-request-id":"54d747f5-e428-4cce-80e9-b42171872158"}}}
2025-05-20 07:23:09,840 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:10","request-id":"b931cbc9-bdce-4d06-9daa-6046fe4fa60f","client-request-id":"b931cbc9-bdce-4d06-9daa-6046fe4fa60f"}}}
2025-05-20 07:23:15,799 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:16","request-id":"8d5d2b1a-b35b-4f26-9b48-b0e1600ff05d","client-request-id":"8d5d2b1a-b35b-4f26-9b48-b0e1600ff05d"}}}
2025-05-20 07:23:17,680 - app.services.drift_service - WARNING - Failed to fetch from Graph API (users): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:18","request-id":"44362655-82bf-4efc-a792-7a18cddc01f0","client-request-id":"44362655-82bf-4efc-a792-7a18cddc01f0"}}}
2025-05-20 07:23:21,560 - app.services.drift_service - WARNING - Failed to fetch from Graph API (users): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:22","request-id":"fa133aec-55cf-4544-bec7-04e07282e7da","client-request-id":"fa133aec-55cf-4544-bec7-04e07282e7da"}}}
2025-05-20 07:23:27,438 - app.services.drift_service - WARNING - Failed to fetch from Graph API (users): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:23:28","request-id":"5a368f53-e122-4c9d-b9ac-c2651638bf34","client-request-id":"5a368f53-e122-4c9d-b9ac-c2651638bf34"}}}
2025-05-20 07:23:27,452 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) no such column: configurationsnapshot.batch_id
[SQL: SELECT configurationsnapshot.id, configurationsnapshot.category, configurationsnapshot."key", configurationsnapshot.value, configurationsnapshot.timestamp, configurationsnapshot.batch_id, configurationsnapshot.config_metadata, configurationsnapshot.retention_policy, configurationsnapshot.validation_status, configurationsnapshot.hash, configurationsnapshot.created_by 
FROM configurationsnapshot 
WHERE configurationsnapshot.category = ?]
[parameters: ('role',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:24:38,369 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:24:39","request-id":"4144cef7-2502-45e9-9dec-b2f480545bb3","client-request-id":"4144cef7-2502-45e9-9dec-b2f480545bb3"}}}
2025-05-20 07:24:42,318 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:24:43","request-id":"925bdb81-8620-473b-be9b-3a6d9f610fd9","client-request-id":"925bdb81-8620-473b-be9b-3a6d9f610fd9"}}}
2025-05-20 07:24:48,336 - app.services.drift_service - WARNING - Failed to fetch from Graph API (directoryRoles): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:24:49","request-id":"3ae28e4b-fda0-4a25-a209-bfc5b5400552","client-request-id":"3ae28e4b-fda0-4a25-a209-bfc5b5400552"}}}
2025-05-20 07:24:50,400 - app.services.drift_service - WARNING - Failed to fetch from Graph API (users): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:24:51","request-id":"e454c229-6815-4197-82b1-bf9c52530597","client-request-id":"e454c229-6815-4197-82b1-bf9c52530597"}}}
2025-05-20 07:24:54,351 - app.services.drift_service - WARNING - Failed to fetch from Graph API (users): {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-05-20T06:24:55","request-id":"12ba7e0a-2193-4ba4-a69c-b8ef7f482a16","client-request-id":"12ba7e0a-2193-4ba4-a69c-b8ef7f482a16"}}}
2025-05-20 07:41:14,284 - app.services.drift_service - ERROR - Error saving snapshots: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('5d81eda4616c4f3a8481b8af5216243c', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:41:14.270425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.269425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('6343997f4270413db79e4ae7e77c5cf2', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:41:14.270425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.270425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('68cf7790b5bd489ca28c96f0cb89e2f8', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:41:14.271425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.270425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('83d2403cdf044f038d24b5e69d43ec41', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('5ebdc4dd67544e4984ab14eb57957cc5', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('fbb882182ffd4cba8c9eece1d97b286e', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('ba61ffbe32fc4e0da7a84b355fb213a3', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('6edcf9bc98c8457e8d1fdbf1553ac3c5', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272559+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('3f4a3c27db0549ffb757dd4df70ee816', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272690+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('5202f17422614d50b0257711c8cf4eb0', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272690+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:41:14,287 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('5d81eda4616c4f3a8481b8af5216243c', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:41:14.270425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.269425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('6343997f4270413db79e4ae7e77c5cf2', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:41:14.270425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.270425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('68cf7790b5bd489ca28c96f0cb89e2f8', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:41:14.271425', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.270425+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('83d2403cdf044f038d24b5e69d43ec41', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('5ebdc4dd67544e4984ab14eb57957cc5', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('fbb882182ffd4cba8c9eece1d97b286e', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('ba61ffbe32fc4e0da7a84b355fb213a3', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:41:14.271552', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.271552+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('6edcf9bc98c8457e8d1fdbf1553ac3c5', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272559+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('3f4a3c27db0549ffb757dd4df70ee816', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272690+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('5202f17422614d50b0257711c8cf4eb0', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:41:14.272690', 'b944847dbeca4cd29afd022cea4077e7', '{"snapshot_time": "2025-05-20T06:41:14.272690+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:42:39,850 - app.services.drift_service - ERROR - Error saving snapshots: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('ef737984db6b42faac8d6e683015d2a8', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:42:39.839165', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.839165+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('427822640f454b04a96161b429f40198', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:42:39.839165', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.839165+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('31854679be624a86a04a1e7648263b2c', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('d24122704c264a2ab02efe762f9654ae', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('02479027fd0840289e8645b88a3ad751', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('3b6be36d8d46493d98910ab3d826c8db', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('5a4ae302f8324e5da2e7c28cbf01e4b3', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('912707e4066e420a8d200da809cf61a0', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('4f61d0f195274556a6e8e91bd27a4724', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('3d314264492e4168b413dcc07a9bc440', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:42:39,852 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('ef737984db6b42faac8d6e683015d2a8', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:42:39.839165', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.839165+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('427822640f454b04a96161b429f40198', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:42:39.839165', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.839165+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('31854679be624a86a04a1e7648263b2c', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('d24122704c264a2ab02efe762f9654ae', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('02479027fd0840289e8645b88a3ad751', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('3b6be36d8d46493d98910ab3d826c8db', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:42:39.840166', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('5a4ae302f8324e5da2e7c28cbf01e4b3', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.840166+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('912707e4066e420a8d200da809cf61a0', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('4f61d0f195274556a6e8e91bd27a4724', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('3d314264492e4168b413dcc07a9bc440', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:42:39.841289', '543b8214baf943adbae3c32587773fb0', '{"snapshot_time": "2025-05-20T06:42:39.841289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:54:17,529 - app.services.drift_service - ERROR - Error saving snapshots: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('8066c5487bc44341a21b99a6f015eb9e', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:54:17.509042', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.509042+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('79e0506cf6144d99af445c0cc959e455', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:54:17.510039', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.510039+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('c4a735c255324d2498a84da8a1509e99', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:54:17.510039', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.510039+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('5d43d969d19c45c6afb4e1a921de9eb7', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:54:17.511118', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.511118+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('df9c0c0140cb4874bd496b04739bbbc2', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:54:17.511118', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.511118+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('dfe312e24f73488f86216d7eeb5de026', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:54:17.512237', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('8ab886f612f346afb3348e7642a83505', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:54:17.512237', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('7b2c4c913f434ea490cab223ac1176fd', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:54:17.513289', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('d954a1afefe04c1ea374af6315923667', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:54:17.514274', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.513289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('3254a1fc6dc44013a3dc08a0c4267656', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:54:17.514274', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.514274+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:54:17,530 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('8066c5487bc44341a21b99a6f015eb9e', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:54:17.509042', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.509042+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('79e0506cf6144d99af445c0cc959e455', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:54:17.510039', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.510039+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('c4a735c255324d2498a84da8a1509e99', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:54:17.510039', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.510039+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('5d43d969d19c45c6afb4e1a921de9eb7', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:54:17.511118', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.511118+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('df9c0c0140cb4874bd496b04739bbbc2', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:54:17.511118', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.511118+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('dfe312e24f73488f86216d7eeb5de026', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:54:17.512237', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('8ab886f612f346afb3348e7642a83505', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:54:17.512237', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('7b2c4c913f434ea490cab223ac1176fd', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:54:17.513289', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.512237+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('d954a1afefe04c1ea374af6315923667', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:54:17.514274', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.513289+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('3254a1fc6dc44013a3dc08a0c4267656', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:54:17.514274', '8856950b2faa4e69a58bb37142110430', '{"snapshot_time": "2025-05-20T06:54:17.514274+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:54:56,996 - app.services.drift_service - ERROR - Error saving snapshots: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('6a5631e32d8443188717f6ed3d3db534', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:54:56.979886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.979886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('e2b5c4e066274126a911fcf0941b5800', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('01e853d492f74c71a35965179b07789a', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('81c16fb1a2f74641980a60e4bb5d1a35', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('d31382723d1c4ab78d4b1bc9a5b4d0f5', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:54:56.981953', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('e824ada5ef46477abf5853acc7b6ada8', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:54:56.982078', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.982078+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('53dfc5d58c9b4542850d86cea1d4f4a4', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:54:56.982078', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.982078+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('1b2321b5899f4c2e857f46b8c2eade4b', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:54:56.983111', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.983111+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('78bdd409fac84bd5af094b06aaeec277', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:54:56.984116', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.983111+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('40af58e39aa84c7893b429d35d6276af', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:54:56.984116', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.984116+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:54:56,997 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('6a5631e32d8443188717f6ed3d3db534', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:54:56.979886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.979886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('e2b5c4e066274126a911fcf0941b5800', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('01e853d492f74c71a35965179b07789a', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('81c16fb1a2f74641980a60e4bb5d1a35', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:54:56.980886', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('d31382723d1c4ab78d4b1bc9a5b4d0f5', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:54:56.981953', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.980886+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('e824ada5ef46477abf5853acc7b6ada8', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:54:56.982078', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.982078+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('53dfc5d58c9b4542850d86cea1d4f4a4', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:54:56.982078', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.982078+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('1b2321b5899f4c2e857f46b8c2eade4b', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:54:56.983111', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.983111+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('78bdd409fac84bd5af094b06aaeec277', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:54:56.984116', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.983111+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('40af58e39aa84c7893b429d35d6276af', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:54:56.984116', 'b45a01b33b554634907492910c15dffe', '{"snapshot_time": "2025-05-20T06:54:56.984116+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:56:41,773 - app.services.drift_service - ERROR - Error saving snapshots: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('09d2fc798ca2480687d9b43b10bdcd19', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:56:41.759806', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.759806+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('821b894eb7f74f69929e71b7a3c91427', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:56:41.760773', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.760773+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('8fbfa58b85ac4694bae02e654c81c37e', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:56:41.761734', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.760773+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('5880b9b32e4543cba5150cae5efae1af', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.761734+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('72faa55c584a42718e4cac01d1aa0d75', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('e798d1e77e8b4aa69719331fbc5b3bb8', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('852e978943544ccdb989ab09fd8fff31', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('5308f5be374d478f97e3be83a3aed500', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('3f7595bff6dc4735b77197856fc5fcd7', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.763031+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('2d03671682ff4fe39db769e249641cad', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.763031+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 07:56:41,775 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.OperationalError) table configurationsnapshot has no column named batch_id
[SQL: INSERT INTO configurationsnapshot (id, category, "key", value, timestamp, batch_id, config_metadata, retention_policy, validation_status, hash, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('09d2fc798ca2480687d9b43b10bdcd19', 'role', '083be1bf-41ff-4b6b-aac1-36159c8ddf7a', '{"id": "083be1bf-41ff-4b6b-aac1-36159c8ddf7a", "deletedDateTime": null, "description": "Can manage the Microsoft Teams service.", "displayName": "Teams Administrator", "roleTemplateId": "69091246-20e8-4a56-aa4d-066075b2a7a8"}', '2025-05-20 06:56:41.759806', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.759806+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "69091246-20e8-4a56-aa4d-066075b2a7a8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2310075e98ddd7aef84ce94e23578b7a6f60e4ec3c13a6d53b44eadc1771831e', 'system'), ('821b894eb7f74f69929e71b7a3c91427', 'role', '23466778-03fb-45ce-95e9-67c0d48a5f1d', '{"id": "23466778-03fb-45ce-95e9-67c0d48a5f1d", "deletedDateTime": null, "description": "Can manage all aspects of Microsoft Entra ID and Microsoft services that use Microsoft Entra identities.", "displayName": "Global Administrator", "roleTemplateId": "62e90394-69f5-4237-9190-012177145e10"}', '2025-05-20 06:56:41.760773', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.760773+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "62e90394-69f5-4237-9190-012177145e10", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '94cb8ef9d6588246e095476033f2cb64d8fd59cf98920e952ec8c9a693bd0fa7', 'system'), ('8fbfa58b85ac4694bae02e654c81c37e', 'role', '38de8738-18ea-489f-89bd-e5336458a4fb', '{"id": "38de8738-18ea-489f-89bd-e5336458a4fb", "deletedDateTime": null, "description": "Can read service health information and manage support tickets.", "displayName": "Service Support Administrator", "roleTemplateId": "f023fd81-a637-4b56-95fd-791ac0226033"}', '2025-05-20 06:56:41.761734', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.760773+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f023fd81-a637-4b56-95fd-791ac0226033", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'fce26475296c53b177ebcaaa3ccbdd47c56fb6e53e034dd71e7c5438ea454307', 'system'), ('5880b9b32e4543cba5150cae5efae1af', 'role', '5e8c30c2-1f32-49f8-9f10-2c37e6b1c961', '{"id": "5e8c30c2-1f32-49f8-9f10-2c37e6b1c961", "deletedDateTime": null, "description": "Can manage all aspects of users and groups, including resetting passwords for limited admins.", "displayName": "User Administrator", "roleTemplateId": "fe930be7-5e62-47db-91af-98c3a49a38b1"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.761734+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "fe930be7-5e62-47db-91af-98c3a49a38b1", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '9013bba3c86c569f58fbb8feafa3416f5125905c69d48957a23dc42342f0f6b4', 'system'), ('72faa55c584a42718e4cac01d1aa0d75', 'role', '730a9585-e761-4fd5-9fe6-098e330c5b77', '{"id": "730a9585-e761-4fd5-9fe6-098e330c5b77", "deletedDateTime": null, "description": "Can read everything that a Global Administrator can, but not update anything.", "displayName": "Global Reader", "roleTemplateId": "f2ef992c-3afb-46b9-b7cf-a126ee74c451"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f2ef992c-3afb-46b9-b7cf-a126ee74c451", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2f6045dcda545e636a8d768a5052929f3f284c1ff3d8fc9ff3635a935a354ab0', 'system'), ('e798d1e77e8b4aa69719331fbc5b3bb8', 'role', '99716ab7-e1d8-4bdd-8fec-8eee65e627fc', '{"id": "99716ab7-e1d8-4bdd-8fec-8eee65e627fc", "deletedDateTime": null, "description": "Can manage all aspects of the Exchange product.", "displayName": "Exchange Administrator", "roleTemplateId": "29232cdf-9323-42fd-ade2-1d097af3e4de"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "29232cdf-9323-42fd-ade2-1d097af3e4de", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '2e7cd78ae95e97a9b1b63f8ae518ae4ad7d0755746cea84ba57557e66b6bc1fe', 'system'), ('852e978943544ccdb989ab09fd8fff31', 'role', 'a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9', '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', '2025-05-20 06:56:41.762023', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '88925d5d0ca46ffc7d4bd797ced68bd18bc8c1da26e1af41f3060d3373df2725', 'system'), ('5308f5be374d478f97e3be83a3aed500', 'role', 'b6dc785e-ad6d-4580-8d79-83b4dd2f041f', '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.762023+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "9f06204d-73c1-4d4c-880a-6edb90606fd8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '33c1080b17f3c6b78ffc8b64d61071e0296c76606be8abdd1c4a44fb10f6a767', 'system')  ... displaying 10 of 11 total bound parameter sets ...  ('3f7595bff6dc4735b77197856fc5fcd7', 'role', 'cadac9be-19e0-4693-b1eb-28905d476b10', '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.763031+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', 'f2d93e0088d17b9ab98a87fb91261defb05c1c588b6e9dc3fc0dbba9f8cbec24', 'system'), ('2d03671682ff4fe39db769e249641cad', 'role', 'd0fa223c-4179-4e3f-98a9-4175f9f75ac5', '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 06:56:41.763031', 'b71919cb7d9a40108d5ddbb7727a09cd', '{"snapshot_time": "2025-05-20T06:56:41.763031+00:00", "item_count": 11, "source": "graph_api/role", "version": "1.0", "role_template_id": "729827e3-9c14-49f7-bb1b-9608f156bbb8", "is_builtin": false}', 'MEDIUM_TERM', 'VALID', '8da59fb16cdd221b85541127a59a89f94874a157a97383e8930e886fe5051793', 'system')]]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-20 08:01:49,263 - app.services.drift_service - ERROR - Error during drift detection: 'coroutine' object is not iterable
2025-05-20 08:08:48,245 - app.services.drift_service - ERROR - Error during drift detection: 'DriftResult' object has no attribute 'changed'
2025-05-20 08:12:19,844 - app.services.drift_service - ERROR - Error during drift detection: 'DriftResult' object has no attribute 'changed'
2025-05-20 08:15:54,750 - app.services.drift_service - ERROR - Error during drift detection: 2 validation errors for DriftChange
change_type
  Field required [type=missing, input_value={'category': <DriftCatego...'fields_changed': ['*']}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
key
  Field required [type=missing, input_value={'category': <DriftCatego...'fields_changed': ['*']}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-20 08:16:51,017 - app.services.drift_service - ERROR - Error during drift detection: 2 validation errors for DriftChange
change_type
  Field required [type=missing, input_value={'category': <DriftCatego...'fields_changed': ['*']}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
key
  Field required [type=missing, input_value={'category': <DriftCatego...'fields_changed': ['*']}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-20 08:31:31,259 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.IntegrityError) NOT NULL constraint failed: driftreport.key
[SQL: INSERT INTO driftreport (id, change_type, category, "key", old_value, new_value, timestamp, severity, status, description, security_impact, affected_components, batch_id, resolution_notes, resolved_by, resolved_at, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('487d1c9ed3474181ad11de3482a6f910', 'created', 'role', None, None, '{"id": "d0fa223c-4179-4e3f-98a9-4175f9f75ac5", "deletedDateTime": null, "description": "Can reset passwords for non-administrators and Helpdesk Administrators.", "displayName": "Helpdesk Administrator", "roleTemplateId": "729827e3-9c14-49f7-bb1b-9608f156bbb8"}', '2025-05-20 07:31:31.155626', 'MEDIUM', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access"]', '74617f8c1c2e4fbb85d4190ec02268fe', None, None, None, None), ('074ea8a3c2dc420f91183ed156b7b493', 'deleted', 'role', None, '{"id": "b6dc785e-ad6d-4580-8d79-83b4dd2f041f", "deletedDateTime": null, "description": "Users assigned to this role are added to the local administra ... (17 characters truncated) ... rosoft Entra joined devices.", "displayName": "Azure AD Joined Device Local Administrator", "roleTemplateId": "9f06204d-73c1-4d4c-880a-6edb90606fd8"}', None, '2025-05-20 07:31:31.156628', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', '74617f8c1c2e4fbb85d4190ec02268fe', None, None, None, None), ('213055c8d9a34bdca80df7d055393b3f', 'deleted', 'role', None, '{"id": "a6a3e6f1-b1a2-4531-b8cc-38321eafa5d9", "deletedDateTime": null, "description": "Can manage all aspects of the SharePoint service.", "displayName": "SharePoint Administrator", "roleTemplateId": "f28a1f50-f6e7-4571-818b-6a12f2af6b6c"}', None, '2025-05-20 07:31:31.156628', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', '74617f8c1c2e4fbb85d4190ec02268fe', None, None, None, None), ('81f043cead47413585aa3b55af24e4b0', 'deleted', 'role', None, '{"id": "cadac9be-19e0-4693-b1eb-28905d476b10", "deletedDateTime": null, "description": "Can read basic directory information. Commonly used to grant directory read access to applications and guests.", "displayName": "Directory Readers", "roleTemplateId": "88d8e3e3-8f55-4a1e-953a-9b9898b8876b"}', None, '2025-05-20 07:31:31.156628', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', '74617f8c1c2e4fbb85d4190ec02268fe', None, None, None, None), ('3a7982b7b89e4ddfbde56051342b850d', 'deleted', 'role', None, '{"id": "b8bb5acd-f9d3-4fb0-b98e-9505fcd73611", "deletedDateTime": null, "description": "Can manage product licenses on users and groups.", "displayName": "License Administrator", "roleTemplateId": "4d6ac14f-3453-41d0-bef9-a3e0c569773a"}', None, '2025-05-20 07:31:31.156628', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', '74617f8c1c2e4fbb85d4190ec02268fe', None, None, None, None), ('8e47daec17c8466880f69f8d2e2947f0', 'created', 'user', None, None, '{"businessPhones": [], "displayName": "Taraoluwa Balogun", "givenName": "Taraoluwa", "jobTitle": null, "mail": "btaraoluwa@standardbearersschool.ng", ... (51 characters truncated) ... erredLanguage": null, "surname": "Balogun", "userPrincipalName": "btaraoluwa@standardbearersschool.ng", "id": "0f0d697c-b448-448b-b384-407f16f2ad73"}', '2025-05-20 07:31:31.238891', 'MEDIUM', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access"]', 'a871c84228fd49c4ac1e9f7e2d7f610e', None, None, None, None), ('4437f89c20f942ec927d63e1dd20587f', 'deleted', 'user', None, '{"businessPhones": [], "displayName": "Sorefunmi Benson", "givenName": "Sorefunmi", "jobTitle": null, "mail": "bsorefunmi@standardbearersschool.ng",  ... (49 characters truncated) ... ferredLanguage": null, "surname": "Benson", "userPrincipalName": "bsorefunmi@standardbearersschool.ng", "id": "f3ed40fd-25f8-4b7d-aaa4-d9c0baa0e432"}', None, '2025-05-20 07:31:31.238891', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', 'a871c84228fd49c4ac1e9f7e2d7f610e', None, None, None, None), ('a11d76ca20a947f1a9a6dfa5990db8fc', 'deleted', 'user', None, '{"businessPhones": [], "displayName": "PURITY BABASHOLA", "givenName": "PURITY", "jobTitle": null, "mail": "bpurity@standardbearersschool.ng", "mobil ... (43 characters truncated) ... ferredLanguage": null, "surname": "BABASHOLA", "userPrincipalName": "bpurity@standardbearersschool.ng", "id": "b32b3509-0aee-4cb6-b1eb-9c58bea7d346"}', None, '2025-05-20 07:31:31.239891', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', 'a871c84228fd49c4ac1e9f7e2d7f610e', None, None, None, None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-20 08:35:33,254 - app.services.drift_service - ERROR - Error during drift detection: (sqlite3.IntegrityError) NOT NULL constraint failed: driftreport.key
[SQL: INSERT INTO driftreport (id, change_type, category, "key", old_value, new_value, timestamp, severity, status, description, security_impact, affected_components, batch_id, resolution_notes, resolved_by, resolved_at, created_by) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [('4bc8fe8322f54f63be4da4cddcc932a4', 'created', 'user', None, None, '{"businessPhones": [], "displayName": "Taraoluwa Balogun", "givenName": "Taraoluwa", "jobTitle": null, "mail": "btaraoluwa@standardbearersschool.ng", ... (51 characters truncated) ... erredLanguage": null, "surname": "Balogun", "userPrincipalName": "btaraoluwa@standardbearersschool.ng", "id": "0f0d697c-b448-448b-b384-407f16f2ad73"}', '2025-05-20 07:35:33.233903', 'MEDIUM', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access"]', 'f569b32c0b8b4d8e97736dd89f7a1cc6', None, None, None, None), ('be44a765f2bd4370ba41731566e8f70c', 'deleted', 'user', None, '{"businessPhones": [], "displayName": "Sorefunmi Benson", "givenName": "Sorefunmi", "jobTitle": null, "mail": "bsorefunmi@standardbearersschool.ng",  ... (49 characters truncated) ... ferredLanguage": null, "surname": "Benson", "userPrincipalName": "bsorefunmi@standardbearersschool.ng", "id": "f3ed40fd-25f8-4b7d-aaa4-d9c0baa0e432"}', None, '2025-05-20 07:35:33.234902', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', 'f569b32c0b8b4d8e97736dd89f7a1cc6', None, None, None, None), ('61d4135110fa4f62b743e21c139ca542', 'deleted', 'user', None, '{"businessPhones": [], "displayName": "PURITY BABASHOLA", "givenName": "PURITY", "jobTitle": null, "mail": "bpurity@standardbearersschool.ng", "mobil ... (43 characters truncated) ... ferredLanguage": null, "surname": "BABASHOLA", "userPrincipalName": "bpurity@standardbearersschool.ng", "id": "b32b3509-0aee-4cb6-b1eb-9c58bea7d346"}', None, '2025-05-20 07:35:33.235900', 'HIGH', 'DETECTED', None, <SecurityImpact.UNKNOWN: 'unknown'>, '["identity", "access", "security"]', 'f569b32c0b8b4d8e97736dd89f7a1cc6', None, None, None, None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-20 08:39:48,826 - app.core.database - ERROR - Database error: create_access_token() missing 1 required positional argument: 'user_id'
2025-05-20 08:40:55,468 - app.core.database - ERROR - Database error: create_access_token() missing 1 required positional argument: 'user_id'
2025-05-20 08:47:59,264 - app.core.database - ERROR - Database error: create_refresh_token() missing 1 required positional argument: 'user_id'
2025-05-20 08:49:11,747 - app.core.database - ERROR - Database error: create_refresh_token() missing 1 required positional argument: 'user_id'
2025-05-20 08:55:24,099 - app.core.database - ERROR - Database error: 'Settings' object has no attribute 'REFRESH_TOKEN_EXPIRE_MINUTES'
2025-05-20 09:22:11,853 - auth.html - WARNING - No access_token cookie found
2025-05-20 09:22:11,865 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:24:09,962 - auth.html - WARNING - No access_token cookie found
2025-05-20 09:24:09,976 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:25:43,783 - app.core.security - WARNING - Token payload validation error: 2 validation errors for TokenPayload
exp
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747740249.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
iat
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747725849.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
2025-05-20 09:25:43,784 - auth.html - ERROR - Token validation error: 401: Token validation failed
2025-05-20 09:25:43,789 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:26:52,825 - app.core.security - WARNING - Token payload validation error: 2 validation errors for TokenPayload
exp
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747740249.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
iat
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747725849.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
2025-05-20 09:26:52,826 - auth.html - ERROR - Token validation error: 401: Token validation failed
2025-05-20 09:26:52,826 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:30:12,145 - app.core.security - WARNING - Token payload validation error: 2 validation errors for TokenPayload
exp
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747740249.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
iat
  Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=1747725849.894315, input_type=float]
    For further information visit https://errors.pydantic.dev/2.11/v/int_from_float
2025-05-20 09:30:12,152 - auth.html - ERROR - Token validation error: 401: Token validation failed
2025-05-20 09:30:12,153 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:30:43,084 - auth.html - WARNING - No access_token cookie found
2025-05-20 09:30:43,084 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 09:33:17,102 - auth.html - WARNING - No access_token cookie found
2025-05-20 09:33:17,133 - dashboard - WARNING - Authentication failed, redirecting to login
2025-05-20 10:22:50,323 - app.core.database - ERROR - Database error: Unexpected end of template. Jinja was looking for the following tags: 'endblock'. The innermost block that needs to be closed is 'block'.
2025-05-20 11:12:08,208 - app.core.database - ERROR - Database error: No route exists for name "create_user_page" and params "".
