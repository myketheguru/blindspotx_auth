2025-05-18 06:02:43,784 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 06:02:46,408 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:05:09,710 - app.core.database - INFO - Value stored securely for key: state:475a4fa9-74a7-44e7-9c9c-7d6e31cd5860
2025-05-18 06:40:07,307 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 06:40:09,772 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:40:24,958 - app.core.database - INFO - Value stored securely for key: state:1dd9c41c-fe18-458f-8305-a5d80b8c3167
2025-05-18 06:43:38,132 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:43:59,314 - app.core.database - INFO - Value stored securely for key: state:820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:44:01,038 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:46:51,185 - app.core.database - INFO - Value deleted for key: state:820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:46:52,194 - app.api.routes.auth - INFO - Created new user: michael@standardbearersschool.ng
2025-05-18 06:46:52,301 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 06:46:52,467 - app.core.database - ERROR - Database error: Textual SQL expression '\n    SELECT DISTINCT p.na...' should be explicitly declared as text('\n    SELECT DISTINCT p.na...')
2025-05-18 06:50:16,784 - app.core.database - INFO - Database and tables created successfully
2025-05-18 06:50:23,437 - app.api.routes.auth - WARNING - Invalid state parameter: 820f2740-eabd-4672-8db9-9b4c30e10529
2025-05-18 06:50:23,443 - app.core.database - ERROR - Database error: 400: Invalid state parameter
2025-05-18 06:50:59,623 - app.core.database - INFO - Value stored securely for key: state:c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:01,576 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:14,175 - app.core.database - INFO - Value deleted for key: state:c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 06:51:15,157 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 06:51:15,168 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: role_permission
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN role_permission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('8aafd2a4-768e-4ed0-96ca-e38592b1d400'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:05:02,296 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 07:05:04,729 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:07:55,351 - app.api.routes.auth - WARNING - Invalid state parameter: c3abbff6-3f38-4bd9-a6e5-5b216479369f
2025-05-18 07:07:55,355 - app.core.database - ERROR - Database error: 400: Invalid state parameter
2025-05-18 07:08:09,571 - app.core.database - INFO - Value stored securely for key: state:c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:11,680 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:21,322 - app.core.database - INFO - Value deleted for key: state:c3fb1c45-471e-4cfe-80c6-c9091f1c34d5
2025-05-18 07:08:22,362 - app.core.database - INFO - Value stored securely for key: refresh_token:8aafd2a4-768e-4ed0-96ca-e38592b1d400
2025-05-18 07:08:22,372 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: role_permission
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN role_permission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('8aafd2a4-768e-4ed0-96ca-e38592b1d400'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:11:51,877 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:12:16,216 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:14:02,087 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:16:13,565 - app.core.database - INFO - Value stored securely for key: state:4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:15,383 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:23,704 - app.core.database - INFO - Value deleted for key: state:4fe61079-de0e-4b9a-bd47-fe48d1fdd04f
2025-05-18 07:16:24,793 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: user
[SQL: SELECT user.id, user.email, user.full_name, user.azure_object_id, user.is_active, user.is_superuser 
FROM user 
WHERE user.azure_object_id = ?]
[parameters: ('1de44d69-ac21-4f02-80df-5481bb7db336',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:27:07,673 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:30:56,516 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:33:01,582 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:33:26,962 - app.core.database - INFO - Value stored securely for key: state:09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:34:44,576 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:35:00,744 - app.core.database - INFO - Value deleted for key: state:09cf1022-b6e0-48cd-b512-dec0ebf3c57c
2025-05-18 07:35:01,963 - app.api.routes.auth - INFO - Created new user: michael@standardbearersschool.ng
2025-05-18 07:35:01,986 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:35:01,993 - app.core.database - ERROR - Database error: (sqlite3.OperationalError) no such table: user_role
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN rolepermission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN user_role ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('3d265172-0d2a-4334-9491-0232e825922f'),)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-18 07:37:08,914 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:37:23,349 - app.core.database - INFO - Value stored securely for key: state:40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:25,542 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:34,839 - app.core.database - INFO - Value deleted for key: state:40ce3824-5b5d-4999-a026-4f5fba7f319b
2025-05-18 07:37:35,958 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:37:35,964 - app.core.database - ERROR - Database error: (sqlite3.ProgrammingError) Error binding parameter 1: type 'UUID' is not supported
[SQL: 
    SELECT DISTINCT p.name FROM permission p
    JOIN rolepermission rp ON p.id = rp.permission_id
    JOIN role r ON rp.role_id = r.id
    JOIN userrole ur ON r.id = ur.role_id
    WHERE ur.user_id = ?
    ]
[parameters: (UUID('3d265172-0d2a-4334-9491-0232e825922f'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-18 07:42:23,489 - app.core.database - INFO - Database and tables created successfully
2025-05-18 07:42:36,436 - app.core.database - INFO - Value stored securely for key: state:f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:38,584 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:53,674 - app.core.database - INFO - Value deleted for key: state:f3aa2b91-c9ca-463a-95c3-5708d5ad1090
2025-05-18 07:42:54,838 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 07:42:54,855 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 10:42:54.855515
2025-05-18 07:42:54,856 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 06:42:54.856513
2025-05-18 07:48:54,006 - app.core.database - INFO - Value stored securely for key: state:0700d50e-90e6-49d8-9d1e-1ec0ec935e1d
2025-05-18 07:48:54,657 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 0700d50e-90e6-49d8-9d1e-1ec0ec935e1d
2025-05-18 08:10:25,227 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:11:10,724 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:12:31,623 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:18:40,764 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:21:32,364 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:23:40,124 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:27:03,873 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:28:09,339 - app.core.database - INFO - Database and tables created successfully
2025-05-18 08:30:45,997 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:03:32,052 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 09:03:34,696 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:04:04,003 - app.core.database - INFO - Value stored securely for key: state:ba9cf14c-f96b-4ba6-99da-1f466972f80a
2025-05-18 09:04:06,801 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: ba9cf14c-f96b-4ba6-99da-1f466972f80a
2025-05-18 09:05:59,554 - app.core.database - INFO - Value stored securely for key: state:fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:00,265 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:17,987 - app.core.database - INFO - Value deleted for key: state:fe1a3b13-dfbe-44a8-a9f4-2a612bfd2fef
2025-05-18 09:06:19,057 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:06:19,080 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:06:19.080754
2025-05-18 09:06:19,101 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:06:19.101348
2025-05-18 09:12:18,737 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:23:43,935 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:23:45,142 - app.core.database - INFO - Value stored securely for key: state:4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:23:47,128 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:23:59,570 - app.core.database - INFO - Value deleted for key: state:4309fbdf-410f-4665-ad62-dcd6a0842dd1
2025-05-18 09:24:00,737 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:24:00,747 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:24:00.747738
2025-05-18 09:24:00,748 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:24:00.748734
2025-05-18 09:25:33,701 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:25:56,439 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:26:14,695 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:26:47,643 - app.core.database - INFO - Value stored securely for key: state:d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:49,736 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:54,043 - app.core.database - INFO - Value deleted for key: state:d1f9bc16-5b0b-4b76-8cea-0d30ceb9827a
2025-05-18 09:26:55,097 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:26:55,105 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:26:55.104611
2025-05-18 09:26:55,106 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:26:55.105609
2025-05-18 09:41:28,338 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:41:47,761 - app.core.database - INFO - Value stored securely for key: state:238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:49,867 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:54,844 - app.core.database - INFO - Value deleted for key: state:238a1f6a-d410-465b-835b-74d96cfad4ea
2025-05-18 09:41:55,880 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:41:55,888 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:41:55.887804
2025-05-18 09:41:55,889 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:41:55.888802
2025-05-18 09:44:47,831 - app.core.database - INFO - Value stored securely for key: state:8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:48,638 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:54,586 - app.core.database - INFO - Value deleted for key: state:8e2e6203-d13c-4b9a-b3fb-08cafe589123
2025-05-18 09:44:55,659 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 09:44:55,675 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 12:44:55.675788
2025-05-18 09:44:55,694 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 08:44:55.694344
2025-05-18 09:48:23,481 - app.core.database - ERROR - Database error: 401: Not authenticated
2025-05-18 09:56:28,430 - app.core.database - INFO - Database and tables created successfully
2025-05-18 09:56:50,100 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:03:17,571 - app.core.database - INFO - Value stored securely for key: state:b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:19,924 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:25,914 - app.core.database - INFO - Value deleted for key: state:b6e918d0-1cb8-4079-bb2e-d6215a688da1
2025-05-18 10:03:27,010 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 10:03:27,033 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 13:03:27.031883
2025-05-18 10:03:27,034 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 09:03:27.034882
2025-05-18 10:05:55,671 - __main__ - INFO - Starting BlindspotX Authentication Server
2025-05-18 10:05:59,227 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:33:07,134 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:36:56,183 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:37:23,013 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:39:56,529 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:47:23,449 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:49:07,384 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:49:07,460 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-5' coro=<run_drift_detection_job() done, defined at C:\Users\bethel-babashola\Documents\darkmyke\blindspot-assessments\blindspotx_auth\app\main.py:70> exception=NameError("name 'detect_drift' is not defined")>
Traceback (most recent call last):
  File "C:\Users\bethel-babashola\Documents\darkmyke\blindspot-assessments\blindspotx_auth\app\main.py", line 72, in run_drift_detection_job
    await detect_drift()
          ^^^^^^^^^^^^
NameError: name 'detect_drift' is not defined
2025-05-18 10:51:24,731 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:51:24,803 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:51:24,805 - app.services.drift_service - ERROR - Error during drift detection: name 'get_mal_app' is not defined
2025-05-18 10:52:17,132 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:52:17,190 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:52:20,779 - app.services.drift_service - ERROR - Error during drift detection: name 'settings' is not defined
2025-05-18 10:53:32,102 - app.core.database - INFO - Database and tables created successfully
2025-05-18 10:53:32,163 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 10:53:34,382 - app.services.drift_service - ERROR - Error during drift detection: 'NoneType' object has no attribute 'get'
2025-05-18 11:00:06,194 - app.core.database - INFO - Database and tables created successfully
2025-05-18 11:00:06,270 - app.services.drift_service - INFO - Starting drift detection job
2025-05-18 11:00:08,316 - app.services.drift_service - WARNING - No cached token found for silent auth
2025-05-18 11:04:53,440 - app.core.database - INFO - Value stored securely for key: state:1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:04:54,320 - app.api.routes.auth - INFO - Initiating OAuth2 flow with state: 1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:05:03,890 - app.core.database - INFO - Value deleted for key: state:1bf13316-c166-4971-b5f2-6d8c7ccc859a
2025-05-18 11:05:05,237 - app.core.database - INFO - Value stored securely for key: refresh_token:3d265172-0d2a-4334-9491-0232e825922f
2025-05-18 11:05:05,247 - app.core.security - INFO - Access token created for user michael@standardbearersschool.ng, expires at 2025-05-18 14:05:05.247903
2025-05-18 11:05:05,250 - app.core.security - INFO - Refresh token created for user michael@standardbearersschool.ng, expires at 2025-05-25 10:05:05.250026
